(ns comp-bio.core-test
  (:require [clojure.test :refer :all ]
            [comp-bio.core :refer :all ]
            [comp-bio.translation :refer :all ]
            [comp-bio.primitives :refer :all ]
            [comp-bio.leaderboard :refer :all ]
            [comp-bio.spectrum :refer :all ]))



; a helper function for basic testing
(defn test-it [test-name predicate]
  (if predicate
    (print "success " test-name " ")
    (print "failure " test-name " ")
    ))


(defn test-clump []
  (let [genome (to-genome "CGGACTCGACAGATGTGAAGAACGACAATGTGAAGACTCGACACGACAGAGTGAAGAGAAGAGGAAACATTGTAA")
        L 50
        t 4
        k 5]
    (test-it "clump test" (= (clump-match-new genome k L t) '("GAAGA" "CGACA")))
    )
  )

(defn test-fuzzy-match []
  (let [genome (to-genome "TATTCAGGCCTCCGGAATGAAGGCCGACGGTGGTTTTTTCACCCAACACCTAGGTTCTGGAGTCAAGCTCCATTGGCCTTGGATTGGAAACGCAGTTTCCAACCTGCGCAGTTCGTCTTCCCTCAATAGCTATCTTAAGGAGCCTACCTGGCAGATTTAGAATGTGAAAAGGTCTTCCCTAGTGAGCGGGGTCATCATCTACGATGGTGGAGCAACAGCTGGAGACTGTCTCCCAGCCTGAGCATCGGCGCGCCTACCTCCTGAAGGATACATCGACGCTATTTAAGATGTGCCACACCTGGTGAACTGTACTGGTGGAAATCCCGGAGTTGTTGTTATGAGCACTCAAAAAAGGTAAGGCGCTTGGTGCGTCACCATCTGCCCCGGTTTGCGGCTGATAATAAGTGTATGGGGAGATCGGTGGGAGGTAGGCCAACCGCGTGCAACCTATTCCTCCGACATATGAAGCCCTAGCTACACTACAAATATCTTCATCCTAAGAGTCATGTATGCAGCCTATTGGCTCACTCTAATTACCTCACGACATGATTTGAGTAACCTACTAAAGCGCTCCAGCTGATGTTTCGTATTTGTACGAGTTATTGACGTCGCCGCATACGATAGATGTGTACGCTTCTAGCTGCATACTTCCCTCTCAAACTTAGTGTGCTTAGGTTGAAGTCTAAAGAAATGTGAATGTATGACTAAGCATGATCTGCGATCGTCGTTATCATGTGTACCGCAGGATCACTCTGTACAGCCAGGCCGTTCAACTTCCGTAGGGTGAAACCTACCTTAAGACCACTATTAATTGCTCACTGGCCTATAGAGGACCCTATGTAATGTAGCCTTAAAAACCCAGCGGTGGATGTATCATCATGCTAGAGAGACCACCATCGCCTCGGCCTATGAATTCTCTGAGTCTTACAGAACTAGTTGCAGTGTACCTCGCCCATTGCATCATCTTACGGCATTCAGTATGGGACTTGAACTCGGAGTAGAACGCAGGTTTTGGCCTTTTATTAAAACCGACCCAGCTCTTTTGGCTTTCGATTCAGTCATGATGCTGAAGCCACCGCTCGGCTGACCTTTATCGTCGCTTATGACGACCTAGATTATTGTCTCTCTCTGTTACATCCGCTATCGGGGGTAAGAAGCTACGCCTAATTGAATCAAGCGCTAGTTCCGCATCTGATATTCATTGAGTTAGCTCGAAGAGCGATACTCGCGCCCAGTTAGTGTATTAGCTTTCTTCCGACACGAATCCCGCTGTATAGCGCGCACCGTGTCCATAAAATGATTAGTCCCGGTCAGCCACAGGTCCCTAACAATGAGGACTCACATCGTGGCGCTAGGCCGAAATAACTTCATTAATCCTGTCCAGCTTACTCGCGATTGCGGACTACTGGCTTGATTCTAAAGGTCTCGGTAACTTATTGTTGGGTAAGCTGAAGCAGTTGACCACCCCCAGCCTGGTCTAATAGATAAAAGAATGGGAAAAACGGGCGCGGATCGAATATCGAAGCCCACGAAATCAGGCCATGTACCGAACCCGGCGTAAAAGCTTCTCCGCGTCACCCGCATGTTGCACAGCCCCAAATTGATCCCTCCTGACTCGTCACGTACGCAATCGACTATTAAAGGGTTCTAACAGAGCGTTCCCGGTCCAGACAGTTCCGAGTACCGGACTAGTAATCTGGCCCATTGATGCGCTTTTGTTTCCTGTTTAAGAATGTGCGGAAGCCCGCAACTTCTAACAGCGCGTATCAGATCTCTACAGAAACGGCGAAGGAGGGCTGGGGATAGCTAGAATCAATATCCCTAATAGTGGGAGTGTCCCTTTGGTAGTAGTCAAATTATGAGGTCGTGAGTCACTATGGCTCAATTCAATAGAATGGCCACGATGTAATAGTCCCTACTGGTCTACGTAAACTTTGACCGGTCTAGTAGTAAGCATGCATACTAATCCCGGTATATATGGTCACTGCCCGGGGAAATAACTTATCCATCTAGTGCAATTTCCTTAGGCAAAAGGACGCTCGGTAAGGAAACGACTAGCCTGAAAACGTAGCCGCCTCTTGGCATTAGGGCTTGTACGTGCTCTTTAGCTTCCGCGGTGATGAGACAAGTTGGGCTTCGGCGCGAAGGGCGGGGTTATTTTAGTGGGTGGGTGTGTGCCCTGTTCCACCCGCGACTGGAGTGTTACCTATTCCGAGATGGAAAGCTAAATCATTGTGAGCTAGGGGACGGTCATAGCGGATCTTCCCGTAGCCGCAGACCGTAAACGCCAAATGAGACAAGACGATACCGCACGCTCAATTCCTATTCATAAAGATGAGTCCAATCGCGGCGGCATACTGTCTATTCTCGCGGTAACATCCAATACTCGATGTCGTGGACGAACTCTCTGCTTGGCCTCTGCGCCCTACGTTCTTTTGGAACTATGGTTCGAGAATCACATTATTCTTTGGACTTCACGGCCGAGTGCCCTCCCGAGCCTCGAGGTCTGTGTCCTTTACTCAGCCAAATATGGACCGTACCCAAGAGGCTAGTCGAATGGTACGCAAGTTGTTGTTATGCAACCAACATTGGCCAGAGCACGTTATTGATAGAGTAGACTTCTCTGGAGCCCAGCTCATCAGTCTATCTGTGCGTAGTTTACACTCCGAGGTGTTTCCCATACGGGCTATAGTCGCCTGACCGCGCGAGGGTGTCAAGGTGCGCGTAGGTTTCCCCCAGGAGAGCATAAGATGCGGTCTAGCCCGCACGGTCTTCAGTGTCTGCTTTACGACGGTCTTCGCGGTTATAAAACCGTGGTATCGTCTTTCATTAGGAATCACGCAGACTGGCTCCAGTACTGTGGACCCTATGCTCGGCTAAGGACTGGTAGTGGCCGACTCGGTCGCCTGTCCCTTTCAGCAAATGCCTATTGCGAGTAAAACCAACCGACAAATAGAAGTGGTCCTTCCGTCTCCATAGACGAATACCCATGAATCGTCGGCAGTCGTGTTGTGCGTAGGAATAATCTCAAGCTACAGTTACTACATGTTCGTCACAGATAGCTAGCGGTTTGAGAGGAATTGGGAAAAGAAAGTAGGTATAACAATGCTAACCCGTACTCCTAATACACTACATCTTCTAGTAAGCCGGTGAAACGGTTGGAGCTCTAAAATAGCAGCCCCGACTTACCACCCCGCTCTGTGCCTTCGTCCCTAAACTCTAATGCAATTGTGATCGGCGATAGGGGTTTTATGATTACCTACGAGTACCGCAGCTAGCACTCTGATGGTTGATATAACTTCGGCAGGGTTCAACTTTCTGTGTGCTTACAGTCCGTGTTGTTATCAGCGCACTATGGCTGGCCTCACCCTGCTAGCCCTTCAGCCGGTCATTAAACCTCTGTAGCCCCTGAGTGCGCGTACCGTAGGAATCGGATCAGAGCGCCCAGTGCGACTGCATATGCCGAAAAAGTATGTATAAGGGTCCATAGTTTTTAAAACTCACAATCTACAGGCGAATAACACAGCGTTGAAGGTTGGTTAGCTCATGCATGGGGCACCCGGCCAGCCGATATGCTTGACCAAATTGATCAAAGGGCTGATTTATTTAAGGGGACATTTATTCGACATTAACCGCTGAATACCTCTCACAGTCTTGCAGACTACGGCTAGCTGGACGCGCGGTCAAGACCATGTCGAAGCTTACGACTAGAAAGGAAGGAGAGATAGGTGCCGATTTGCGCTCGCTCTGCTAGCAAAACTGTATGTCTCGAGCGAGTCGACATTAAGTTATATCCGCGTTCTCGGTCAGCGGCTAAAGGTGAATTTGCAAGTTTAAGTCTAACACAAATATAGAATGAGGCTTGGTCCCACACCTAGAGTATGTTCCTTACCGCTCGATCGCACGGACAACGCCAGGGACTATGCTTAAGCGGGCCAGGACCCTATAAATTTATAAGCTGCGCTTTGAAACGATCGGGAGGAAAGGCTTGCAAACAGTTTCGGCTCCCAAGGGGTGCAGTCCTCTGGGGATTCGCCCGCTACTTCCACCAGAGAAAACTTCGTCTGAGACTGCCAATACGGCTTCGCTCACTAAGAAGTGATGGGTAGGTAACGTATACAAGCTAGAATTGAATTACTCTTCACAGCCAACTTTTAGATGAGGCTGGGCCTGCTGTCTCCTGCGCTGGGTGACCTAAACAGTTAATTTCATCCCTATCATGGGAAGGTTCTCAGGTTGGGCTAATGAAAGGAAGCGATCCTTTGCCAAGGTGCCCTTAATGTTATGGTACAGGGTGGTCGCAGCAGCATGGGGGCGACACCATATGGAAATTGTACGCGCAGGAGGCATCTCTACGTATAGGTAGCTCGCCGGACATGCGTTCGGGAGCGCAACTGGCCCGATCAGCTACGGTCGCTTTCAACGATCCCGAAAATAGGTTCGAGGTCAATCGACAGATCGTCGGTATCGTGGAGGGAAGCGAAACCGCGGCAAGGTGTCACTGGTCCCTATCGCTAGGAAAGGACACACTAACTGAATGTGTATCGCAATGACAGTTCGTGAGCAGATGTACAATTTTTCACAGTTCTTCTAATGTCGGCGCTTGGCTTCTGAATCAGTATACTAGTCATTTGCGGGCTCGGCGCGTAAAGACCCTGCTCGCTTTGAGTACCATCCCGCCGGCTCCACGCGTCAAAGTAGCAAGCCTGCCAAAACCCAAATGTCACGGAGATGAGTTTGCGAAGATAGGCGTTTGCGATGTAGACTGGCCAACAAGTTGAAGGTGGAATGACTTCTAGCTGGCTATGTTGCCAGACCAGGCCAACAGGGTTGGGGAGCCACCCTGCACCCCTCTGCGCGTTCGTAACCAGTGCCCCGCTTCACAAATGTTGTACTGGTGTTGTCTGAGAGACGGGCGACAAGCTGTTGAGGCCAGTCCGATTGATTCCTGCATGACTCGTTATGTACGCCCTATGGCAGCTATAGTAAGTGTAGGTCCTCACATTAATATTGGTTGACGGGAAGACTCGGCGGGCTTCCGAGGTCCTGTATCCAAGTCAGCCGTAGCACATCGTCTTATAAGGCGGACTAGCACAAAATCACCCCACACCTACGGGTGCTGTCTCGCTGTTACGCACCCCGAGGTTCCAGCAGGACCGGACCTCATACACCAGTAGGGTTAGGCAAGGTGGTGCTAGGACATCATAAGACTACGTTCCCGACGGAAAAATGGTTCAGGATCGACATATGCGCACCGATGAGCTTGTATATCAGACTTCCTTGTTGGATGGCCAATTTCAAGAGCATAGCGCGAAGACGGGTTTTTGAACTAGAATCAATAATGTGTCCGACGGGCATGCTAGTGGGATATATCTGTTCCAACTCCACAGTTGACGACACTGTGCGCCTTTACACACGCGAGAACGAACGGGGTGACCTCATAGTGGCAGATTAGAAGCGAAACTAACCGTCCGCCCGGGCGAGATCCCAGGGCTTATTTTGGCTCGTTGCCCGCGCAATTTCTGGCCCCCAGATAATCCGAAGACGCGATAGTGGTCTGAGAACCACGCTGAAATGTGGGAGAGAGTATACAGAGAGTGTCAGAATTGATATTCTCCTCCGTGTTGGTAACATAATATTCATGCAGCCAAGGTAGCTCATAAAAATTAAGCGTATTAGATAGGATCTACAGTTGCGCCGTCTCGGGTTAGATTGCTTCCTTTAATGCCCGTGGTGACTGAACTGTCTCACTGCCAGGGAGTTCCATCGATAGTTAGACATTCAACTGGGTTCCAGACGTCAATTAGGTTCTTCGGTTTGTTGGTAACGTATAGGTTTAGAGATTGGAATAATTACTTAATTAATTGGGGTAGCGGTGAAAAGAAACGGCCAAGGTTGTACAGGCAACGCTAATAGAGGTATCTTAGTCATGGTGAGAGGGTGTTTGAGCTAATTCCTGACGCTCGCCGACATCATGGCAGTGGTTGCTGGCTCACCCTAACACGGGAGAATTTAATAACTGCGGATGTAGTAGCCCTTTTATGCGATGGGCAGCCGATCTTTTACCGAGTCGGATGATATGCTAAAATCGTGAATTGAGCGTTGATGGGGTCGTGAGTTTTCCTCCGACCTGGTACATTCCGTAGTGTCGATGGGGCTCGGTATGACGTCAGCGGCCATATCACTCTTCGCGCAGCGTTGTTTGGCTCACTATCTCGGCAATGAGTTCCGACCACGAGAGCACTCCGTAAACGATCCACAGCTGAGACACGGCTGCTCGGCTTTAGAATGGGATCTGGATCGCGTGGACCAATTTCCCAATCCAGCATCACACTGTGGCCTTCGTATGTCCCACCGACTGTGACAGGTCGGATCCCAGATAAATTACCCCTTCTTCCTCCTCAAATTGGAATTGTGTTAGCTCGTTTCTCTCTTGAAGACTAGAATGCGATCGTCATGTAGCTCGCTAAACGGTACATTGAAGTTCAAACAGTTTTTTCATGTTCCATGAGTTGTACTATCGAGTTCAGCTATCGACGTCTTGTAGTTCCCTGCCTGTGTACATAACATCCTTGTATGTTGAGGCCGTTTATACCTATTATTGCCATGGGTGTGGGGGTCAGAGAAGAAAAGAAGAATTGTACTTTGATCGTTGTAGACTGGTCCTTTCACGATTGGAGTTGTTGGACATCGTGGAGACATAGCTTCGCTTGGAGGTCCCTCGCTCAGATCAACATGTTCAGGAGAGAGGCCTTCAACGTCGTCGATCTTGCGACCCGTCTGATGAAGAAACACTGAAGGGGTCATACACGTCAGACCTTACGCATAGCAGTACTTAATTTTTGCTTACTCGCCCCTTAAGGCGTGATCCACCCTGGAAGTTTGTATATTAAATTATTCGCTCACTGGGAAATGAGCGAGTTCGGTTCCGCGCAGAGGAAGGGACCTTCGATCCAGCACACCCATTCCCGACACTCTCTGGAGCGATTTAGGTTTGAGCCCAAATTTGGTGCGGGCGACTAGATTGCTGACCGGGCTGCCGCAATAGGAGTTTCGGCTCGCAGGCACGGGATTCTCATCTACGGACCCCATTATGCGTCAAATCGTGGAGATACGACAAGATGTGACGGTGATGGAGCCTACCCGTAAGGTAGACTTGATGCAGGTGGTCTTTTAGAATACCACGGCCGATCAGGCGGGACATCCTAGTTAAGATGCGTGTCGACCCTGTACTAAATAATGGCAGGTAGGCTACAAGGATACAACGGGAAACGCAATTTGAATGAGCGACCTTAAGGATCGGTGCACTGTCACCTTGCCGCTGTAGCAGATCGGCCCCTCCGCTTTCCATAATCTCATTCCCTAATAGACGCGATGATTTGTCTATCGGGGGTTTATACACGCGCTAGTTAAAACTCGTGACTGATTAGCTGATTTCATTTCCCCCGTAGGTCGTGAAGGCAAGTAGGGCTTCCTGCGTATCGGATTCGTTACGCCGGGCTAGGGATTACGTACAGACGTACTACACCGATGCGGATCAAGCTCTAGTAAGAGAAAATCTGTCGAAAGGGCACTTTTCATAGGCAATTGTACTTTTTACTGTGCGATCGTCTGCTCTTGAGCACGACCAGTTTTTTTCCCGACCAGCGCTCTTCCAGTAACTCCATCCTTGGTTGCCTGGCTCAAGTAACTTATGTTGGCAGCATTGGAGATGTTCGGGGAATGGCCCGTTGTGACGCAGCGCAACTACTAGCACAGTGACCGGATCGTTCAGGACGTCTGGTAGAAATGTTACGTAACTCGGGGTGGCAGCGAGGAGCCTATGCCTCCTGTTGGTGTCAGAATCTCGCTTCAGAACTGCCAACAACACATCGAGCTGTCGGATCGGGATGGTTCTTGGTTGATTCCATGTTCACTTCGGGTCAGCTGGCAAGAGAGTTTGAAAGGCCCATCACTCGGTCTTCTAGCTGACCTTCGCGGTAGCGAACCCATTAGGACCTTGCCGAGTCTCCAACCCGAGAATACCAGATGCGTACGTTACGCAGCGCACCGACTTGTAAGACCATAGCATTTTAGATGGATCATATGACGATGCATCGCATTGAATCTCTGATTCGACACCAAGCCCAAAGTGTTAGCTGCTCGAACCGTGTTCCCACGGTGCCAAAGTCTCTAAGACGTTTACCAGGATCGTAATTAAGTATAGTCCAGACACGACCTGACCGGGGGAGTGCACGTTCTGAGTTCAGAACTGAGTTGTTGTTATGGAAAGAGCTTCTTGAAATCGTCAGTGTAGCAGTGCCAGCACGATGGCGCCTTTCAGAAATCCACTACCCGACCGGATATTGTGATGGTTGCGGGCTCCGTAGATGCGTTTGGAGAAAAGTCTGGGTCGAGCATGCGGCATGACTTCCAACCAGGCAACGTGGCTCCAAGGGCTGGCTTACTAGCTTCTCTTAGGTAACAAAAGAGCGCGCACAGCGACAAGAGTTACCATTGACTTGGCTACACACTTGATTGCATGAGGATATGCCCGTCGTGCTCCGAATAAACGACGGTGGGATATTGCATAGCCCAGCCCCTTCTTTCGAACGTTAGACCCGCAGTACTCTTCTACACGCCCGATCGCAGGCAATAATTGAGCTAACAACATATGTACGCGTAGCCAACACCACCCGCAAGTGAAGGTCTCATTTTCACACTATAGGGCTTTCGCGGCATATATATGCATCCCCACGTCGGGAGGAGTGTTCCTCGTGCATCGGTGTAAGTCCTATAAGGGGGCCCGATCCTCGCATCGGTTGGGAATGACTCGCTGCACATACCACTCCTCCTTAACCAATACGTTCCGGTCATGGTCCCAGTCTGACCTCATAACTGTACGTACCAGGTCATTCATTAATACTGGCGATTCTGCTCCGTGCCCATGATCAGAGCAACCTTCACTCCAGCACGAAACTGTTTAGGAATACCGTCATTTGGTGACCGGGGGCGGTTTGCGTCTCATGAGGATGTGTAAATCCTCCCAGAGTCGGAACAGGGCTGTATCCTTCACACAGGTCAGCAACACGTCTTGCGACGGTACGTGATAAATGCTCTGGGCCGGAACAAACTGCCGTTTTTGCCAGAATATCAGGATGTACAACTACATACAAGAGGACTCTACGGGAACATTATTTGCAGGGGGTTACTAAGCCCGTGTGCTTAGGAGAAGTTTTTGGACTCTGGACGAGGGTCCCGTACCTGCGTATCAGGCACGAGCGGTTCTCTTGTACGACTCCTCCGACGCCCGGTTCGGTCGGAGGCTTGGCTTAGGATGTGAGGTTGACTACGTCGCTCCGGTTGTCGGACGCTCGGCCAGGTAACTTTCTGACCACTGGATTAAGTCGGTGGGGATTTGTGCAAAGCTGAGTGTGCGTCGAGGCAAGAACTCGGTATATCATAGAGCTGTTTGGTAGGTTTGGTTACACGGGTGAAAGACAGGGGCTGGTGGCACTATGTATGACGGGTCCGCGCGTGATTTTTCTAGAGTTTGGGACATTAGGGGAACTACAAGCTTCAGGAGACAAAGTGAACCTCATCCGATGATCGCGCTTTTTTGGGTTCTGGAGTGCTTGTACAGCTACGATGTCCCTAAACTGAGTGGGTGACATTGTGCGAGACTGTTAAATCGCACATGCACCTACTCTATACTTACAACAGAGACGTATAAATTCTAGAATTCAATGTCCTAGAGGCAGCCGGTGGTGCCCCTTCCGTCAGCCAGGAGTGCTCGAGGGACCGCATCACTTGCCGTACCACATTCAGATGCAGGATCATGCGACAGATTAACGATGAATCGTCAAGTCGCAGGTAAGTGTTCTATCACCCGTCAGGGTCCGACGCCACCCAGCCTAGTTTGTGGCTGATTCCGAATAATTGTCACTTCTGGTTGGCTGACTTTCAACGCTTTAATCATACAATGTTACCCCCTGATGTGTGGTGGAGTTTCTTGGAAACGTGTAGGCGCGATTGACATGGGGCCCCAGTGTGCATAGCATTATGATGCCTCAAGCTGCACGTCTACATTTTATCCGATACATCTTCGGTCATGAGGCCCTCAATGATGGGGAACTTCGTTGTAATAATATTAGCTGTCCGCCTTTGGTTTCTAGCGGCCGCTATGGGTCAATCCAGATATATGGGAGTCCAGTGTTTAATCAAGGAGAAGGTACGGCGGGTTGGTAGGTTATCCAGCCGGCACCTGTAAAGCCAGTATAACTTGCTGAATCCCAGTAGTTTAAGAGAACCCTCAATGTACCTACTATATTTGCCCGCCCGAGGCCCACATTAATGGCGTCTTACCGCTAAGCCGCTCTACATCGTTACATCGGGGGCGCCTTGACTAAGTGGGTCTGGCAATAGTTGCCTGGGATTAATAGTAACCTCCTAGGGGCTGTTAGCCTTCACCTTCCTTCACTGATATGCGTGCTAGTGGCTGGAGTTTTTATTCCCACTATAAAAAACATCATGGGAGGGCGTATTGAAGGCCATCATGGTTTCTTGCGGTGGGCTTCTAAGGAAGTGGGACACGTGCTCGTCGATCGCCCTGCCGGTCTAGGAGGGACTGCTGTTGATGAGCTGACCTAAGGGTAATCACTGGGATGGCGTTTCGGTACCATATTATAATTGGGTCCGCGATATTCGCCGGCCTCTCTCCACGAGTTCAGCATCCAGTCAGCTTGCTGATGATTACGTCCGAAACTGACACAGGGTCCCGGCTATGGCGAGACCGCGCCAAACAGGGCTGACAGATGCGCCTCTTGAAGTACCCCATCGTGATGTGGTAACTGCACTCGGATGTTTAATTGAGGGGACTTCGGCCTATGTCTCGGGCACTCCTGGTATGGTGTCCCAGTAGGAAGGGCTATCTTACTCTTGAGACAGGTCTTAACCTAGTCATCAGACGCTTCTCATCTGAGCAATAGGAGGTTTGTTACCATGTCGTTTACGCACATTTGGAGACTAAATCATTGGATGTGCGGCTCGATAAGATCCTAAAGAGAAGGTCTCCGGTAACTTCCTAGACGCTGCCCTAAAGCACACGGCAAATCCGGGCGACAAATTGACGCCCATGCTATGTATTCTAGGACGGCTACATGCAAGTATGAGACTTAGCTTCTCAGGTCGCTGTGTAAATCGATAACGATCATTGTACTCCGGCAGACATCGTACAAGCGGTCCTTTCCGGACAACTTGTGGCTCGCGTAGTAGATTGGTCACAGCAAAGAGTTGTCCGTAGAGTATCGAAAGCCCTCAACAAGTTCTTCCAGGAGCTCCTTTATCTTTATGAAAAGTCAAACCATGAAAGGTGGCGGTGAGTGAGTCTCGTAGATTTAGAGAACGCCTGATCGCTGTTATAGGCGATCCGCGTCTGTGCTAAGCGCGACATGACAATCGAGTGGATGTTAACAACGTTACCAAGGCGTAAGTTTTAGTTATGGGGCACTTGCTAATGCCCGCGATGGTGACCTCTTGCCTACGGCTGTAGACAACTCTAAACATACAATTGGCATAGCACCCAAATATCTCAGATCAGGGACCGTAATCTCGGTCACAGACAGTTGAAAGGATGATATAAACGAGGGGAGTCAGATTATAGACATTAAGACAATCCTGCTCAGTAAACGTGTTTCAATACTCGCCGGTCGCAGAGCGATGTGTAATACCATTCAAGTGTGTCCCGATGATTCTTCTGATTCATCCCATCTTTCGCGACGCTCGGGTAGTGTCTTGCAATGTTGCAACTTGCCATGTAATGCAGAGGTCCTGGGCGCACTCGGCGGATAGAGTCCTTGGCTAGCGCATGGGCTCGGCCAAGATCTCAAGGACGCCACGTCTGCCGCACAACTCAGAAACTGCACAAGGAGCAAGTTGCAGCTTTAGTTGCCCGTCAGGCACTCTTAGTGCAGTAGACAAGACTGGACGGAGGCTAACCAGCACGTATCGCATGTTCGTCGTCAGTGACACAGATTAGATACCCTTATGACCTCCCAGTGGAACCCCGGCTTCTTGACCGCCGGTAAAACGGTTTCTATTGACCGGTACACAAGTCTTCTAACTATGCAGACGTTGTAAGATCCATCTCCACCCTGCCATGCTACGCGTCGGATTCGATCATATCAACTAACAAGCGACTCCTAGCGAGCTCTTTCTGTCACCGTAGCGCTCATCCAGTACTATAGCAAGCGGAACAGGCTCCAAACTGTTCACTGCCGTTTTTGAACCAAGCAGATTAAACTTTCCGGCCAGCGTTGGTCAGTAGCTATAAGTCATGACTTCGCTACATCGACCTTTATGCCGTGTTGCGGCGTCAAGTTGGGATATTCGTCGAATTTAGTTAAGGGTTTGAAATCGATGTAACACATTTAGTAGAAGATGTCTCATGACCCAGGGGCAAAGTGTTTCGTCCCCACTGCTGTTGTGACAGCGAGCAAGCCAGTGTTAGCTCGGCGGCCGTGTAAAGCTCGTCTTGTTGTGATCCCTCGTGAGGGGGAACAAGTTGCAAAAAGCTCCCCCATACTGGCGCCTTAAGTCGGTTGTCGTCTGCCAGACAGATTGCAAATCAGAACGTGCACATTATTCACCGCATGTGCCGGGTCAGTGTAGCGCAGTATTCGAAGATATAGCGCCATACATTCCGCCTGCTTCCGGGCTATTCTGTGAATTGCTGGGTCATTCGGAAACATTCAAGTATTTACCATAGGAGGTGAAGTTCCGTGGCGGTGAGGGCATGCAGAGCACGGTGTATACTCAGAATATCTGCACCGTGACGGCCGGCGGCTTTTCAGTCACAGCCCGCCGCCACGCGGCGCGGGTTACCCATTATACTATATGTTAATGGGGCGGCAAGAGGATCCCTCTTGAACAACCTCTCATCGGGGAAGCGTTTCCATAGCTGCTTATCACTGACTTCATCACTGGGGGTTAAGTCCTTTTAGGTACAGTCGATACGTTCATTCTATCTATTCGGTAGGAGGCGTAAGGAGGCGGGGTCGGCGCCTCATCGATTCGACATTCTAGGGAGGCTTATTGCCTTCCTCGCTTCTTGCAGAAATGGTGGGTGAAACGGCACCTTGGTCGCGTTAGGACCAAGATGCGTAAAGACTGATGTATCGGTGCATTCTGGGCAATTCATGGGGTTAAGGCATATCATTTTGTCTCCTGACCGTAGACCCAACCTTTTGCGCCTGTCTTCGGCTATCACCAAATCTTCTCCACAATCGGACGGTGCTACAATAAGACCATTGTAACCCGCGGCAATAAGCGTAGTTGTTTTGCTAGAAGGCCTTATTGAGCGACAGTCCCGACCATATACGATTATACCGCTCCGCCATCGGATCGAACATCCAGGGCTTTTACGGAGTAAATACTACACTTAGCCTAACGGTGGACTGTCCAGTCGGCGGTGGCTATCGGTCCAAATCCTGCTACGCAATAACACAAAGTCAGAGTTCACGAAATCAGTCGAGGAACGACGAGGCCCGCCTTCTACTAGTCTATTTGTGACTGGCCGCACAACCAATGGCTTATTGATCGGCAAATGTAGGGACCCTGCGGCGGCGCCCGCTGCTTCAGGTGACAAGTTGGGGCTCTTGGTTCGCACAGACAGAATGCATCGCACGCTCTTCAAATGAGGAATTTCGGAAACATTGAAGCGCCTTCCTGTCGCTTATTTGTCAGAAATCGTCACTTCAACCATTGCTCGAACGTCCGAGCCATGAAAGGCTAATATACGTGCTTTCGGCGCATGGACCAATTGGAGAGGAGCCCGGTACAATCGGCCAATATAGAAATTGCACGAGGCGGAGCCGTCGCTGCACCTGACTGCCTGCCCGGTCGACCTGAGCGGTATGCTATAGGCGGGACGAGAGCGGGTGTTTACTTCCTCGAGTTCTCCAGTCCGTCTCTTTGAGACAGCCTTTTAATTCTAAGTGCATGAGAGGCAAGGAAGAAGTTCAAGTTATGGCGGCTTTTCGCAGTCCCCTACTAAATGATTCAGAAGAGTTCCTATCAACTATGCACTACCGCGATTTATGTACTTAGCAAGCTTGCGCGTGCGGACTTTCAACGGACCCCAGCGGATGCTTCGTATACGAGAAGAGTCGACCACAGCATTTACTGCAAGGCTTCCTCAGGTGAATTCTACCAGTACACGACGTGCCGTTTCTCGTCGCAGGATGGAGTACGAACCACCGCCGGTGAAGTGCCATCACTTTTTCCACGCGTGGACATAACTACAAGGAAAACTTCCTAGTGTGAGGCCCCACTCCATTCTCCTCAGCAAGCACCCGTGTTTCTGGCCCGTGCGCACACATCTGCCTCCAGCTCAACGCCACCCACGAATGCGACCACCGCCCACGTATATAAAGCCCAGACGCACCCTCCAAAAACATTATGGTCCGATCCACTAAGCTCCTTCTAGGCCTCCGTGGGTAGGTCCCGTCTTTATAATAAGATCGCATAGTGCAATCTGTAACCTGCGGGGAGAACTTGGCCGGGAAGAACGCCGCACGTCGCTATCCTGTCCCTCGTTGACTAACATTGCATCCAGTATCTTAGTCGGTATACTTGGCTAGTGGTGCGGTTGGGTGGTCGGAAACCACGTACTTTATCTCCGCAGTCTGCTGTTGGAGACTCGGAAACTCCTGGAAAATGCAAGTTGGTGTGGAGATAGCGACGCCACAAAAGGATTAATATAGGATCCCTCTTCAATAAACGCTGGCTACTTCTCTCAAGGGTAGGGGATAAAGTCGTCAAAACTACCAATCGACCATTTTACGGCGTGTTTATTACAATTAGCCGACGGTCCGGCGATGAAGAATGGCTCCGGACGCGTGTTGGCGTTCACGCAAATCTCGCGGGCCCCACGTTATCTCTCTTCAAACATAGGAATTTGAGCAAAGAGTGAGCGCGGCACCAGAGTATTCGGTACAGTCCAGGTATCCGCCCCCGCCTTTGAACATTGTCCCCTTATAGAACTTGTACAAACTAATATAATGGGCAACGGCGCTTCTACTGTCTACGATACGACTGACTACAAAACAGATTCAAACAAAAGTCGGTGAGTTCTCCTAGTGGCGCTGCGGTACCGACGCTATACGTTCTTTAGATTGCCTCCGCAGCTTGCGGCAACTGTGTGTATGTGCATTTACTTCTTATCCAACGATTAAACGCTGGCTGGGGCGCATGCATACACTCGTGCTAGCTGCTCTGCCTCGACGAGCGCCGACAAGTAATCCAGGCGAACTCAACCGTAAATTTCACGAGATCTGGCGCTCCGGCTAAACCGACACCGAGTCCGTCCGCCTTACGGGCGCAGTACGAGCGGCAAATCTGGGAAGGGCTTTCCTGAGGTTCCATAGTATAGACCGATTATTTCGACTGCCTACTACAGTAGCCATAGAGGTAAACTGAGCCACCAGGTAAAGATAATAGCTCCGTAAAGGCAAAACTGTGTACGTCCGACTGGAAGGAGTCATGCACCGCTACAACCTGTAAGCATCTTTGGATATGGAACTCAGCCGCGCAAGCGTATTCCGGCCCCCACTGATTCTCCGAGGTCGATAGTACGCACATCGAGAGATTACTCCGGGTCGGCCACCGAAGTGCCGAGAAGATAACGGTGCAGCGGCAA")
        pattern "AGCGGCAA"
        d 5]
    (test-it "fuzzy match" (= (count (sort (approx-pattern-match pattern genome d))) 4979)))
  )


(defn test-min-skew []
  (let [skew-list (to-genome "TAAAGACTGCCGAGAGGCCAACACGAGTGCTAGAACGAGGGGCGTAAACGCGGGTCCGAT")
        data (min-skew-data skew-list)]
    (test-it "min skew" (= (min-skew data) '(11 24))))
  )

(defn test-best-fuzzy []
  (let [genome (to-genome "CACAGTAGGCGCCGGCACACACAGCCCCGGGCCCCGGGCCGCCCCGGGCCGGCGGCCGCCGGCGCCGGCACACCGGCACAGCCGTACCGGCACAGTAGTACCGGCCGGCCGGCACACCGGCACACCGGGTACACACCGGGGCGCACACACAGGCGGGCGCCGGGCCCCGGGCCGTACCGGGCCGCCGGCGGCCCACAGGCGCCGGCACAGTACCGGCACACACAGTAGCCCACACACAGGCGGGCGGTAGCCGGCGCACACACACACAGTAGGCGCACAGCCGCCCACACACACCGGCCGGCCGGCACAGGCGGGCGGGCGCACACACACCGGCACAGTAGTAGGCGGCCGGCGCACAGCC")
        k 10
        d 2
        best (best-fuzzy-pattern genome k d)
        top (extract-top best)]
    ;(println top)    #{GCACACAGAC GCGCACACAC}
    (test-it "best-fuzzy-patterns" (= (count top) 2))
    )
  )
(defn translation-test []
  (let [dna (to-genome "AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA")
        rna (to-rna dna)]
    (test-it "protein translation" (= (apply str (transcribe rna)) "MAMAPRTEINSTRING"))
    )
  )


(defn peptide-test []
  (let [dna (to-genome "ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA")
        aa (to-genome "MA")]
    (test-it "peptide test" (= (count (peptides-of dna aa)) 3))
    )
  )
(defn codon-test []
  (let [input (to-genome "LEQN")]
    (test-it "codon test" (= (spectrum input) (list 0 113 114 128 129 227 242 242 257 355 356 370 371 484)))
    )
  )
(defn leaderboard-test []
  (let [stest (list 0 71 113 129 147 200 218 260 313 331 347 389 460)
        sn 2
        answers (leader-board stest sn)]

    (test-it "leaderboard test" (some #(= '(113 147 71 129) %) answers)
      )
    )
  )


(defn test-suite []
  (time (test-clump))
  (time (test-fuzzy-match))
  (time (test-min-skew))
  (time (test-best-fuzzy))
  (time (translation-test))
  (time (peptide-test))
  (time (codon-test))
  (time (leaderboard-test))
  )


(deftest a-test
  (testing "All comp-bio tests"
    (do (test-suite)
      (is (= 1 1))))
  )
